{% extends './layout.html' %}
{% block content %}
<div class="container col-md-8 col-xl-6 my-4 p-4 border shadow ">
    <img src = "{{post.image.url}}" class = "card-img-top m-0" / >
    <div class="border-0 p-0 d-flex">
      <div class="col-9">
        <p class="mb-1">
          <h4 class="m-0"> {{post.author}}</h4> {{post.description}}
        </p>
      </div>
      
      <div id="{{ post.identifier }}"class='d-flex justify-content-end col-3 p-0'>
        <a
          type="button"
          data-post="{{post.identifier}}"
          class="fs-5 text-reset like-button"
          >
          {% if user in post.likes.all %}
          <i class="fas fa-heart text-danger"></i>
          {% else%}
          <i class="far fa-heart"></i>
          {% endif %}
        </a>
        <p class="fw-bold fs-5 px-1">{{post.likes.all | length}}</p>
        <p class="fw-bold fs-5 col-md-auto">Me gusta</p>
  
      </div>
    </div>
  
    <hr class="mt-0"/>
  
    <div class="mb-1 row comment-div border-0">
      {% for comment in post.get_comments %}
      <p class="mb-0">
        <strong>{{ comment.user }}</strong> {{ comment.body }}
      </p>
      {% endfor %}
    </div>
  
    <hr clas='border-0'/>
    <form class="row" id="comment_form">
      <div class="d-flex justify-content-center">
        <img
          src="{{user.profile_pic.url}}"
          class="mx-2 rounded-circle my-auto"
          height="20"
          width="20"
          alt=""
          loading="lazy"
        />
        <input
          id="comment{{post.identifier}}"
          class="form-control  my-auto mx-2"
          placeholder="AÃ±adir un comentario..."
        />
        <div>
          <button
            class="btn btn-primary btn-sm my-auto btn-block border comment-button"
            data-post="{{post.identifier}}"
            type="submit"
          >
            Publicar
          </button>
        </div>
      </div>
    </form>
    <hr />
    {% for producto in productos %}
                            <div class="col-6">
                                <div class="card" style="height: 10rem; width: 23rem; margin: 5px 0px;">
                                    <div class="card-body">
                                        <h5 class="card-title">{{producto.nombre}}</h5>
                                        <p class="card-text">{{producto.categoria}}</p>
                                        <p class="card-text">{{producto.precio}}</p>
                                        <a href="{% url 'Add' producto.id %}" class="btn btn-primary">Agregar al carrito</a>
                                    </div>
                                </div>
                            </div>
                            {% endfor %}
    <div class="card-footer border-0 py-0">
      <p class="card-text"><small class="text-muted"> {{post.published}} </small></p>
    </div>

    <div class="alert alert-primary" role="alert">
      <table class="table table-bordered">
        <thead>
          <tr>
            <th scope="row" colspan="3" class="text-center">CARRITO</th>
          </tr>
          <tr>
            <th scope="col">NOMBRE</th>
            <th scope="col">PRECIO</th>
            <th scope="col">CANTIDAD</th>
          </tr>
        </thead>
        <tbody>
        {% if request.session.carrito.items %}
        {% for key, value in request.session.carrito.items %}
          <tr>
            <td>{{value.nombre}}</td>
            <td>{{value.precio}}</td>
            <td>{{value.acumulado}}
              <a href="{% url 'Add' value.producto_id %}" class="badge btn btn-dark badge-dark">+</a>
              <a href="{% url 'Sub' value.producto_id %}" class="badge btn btn-dark badge-dark">-</a>
            </td>
          </tr>
        {% endfor %}
        {% else %}
        <tr>
            <td colspan="3">
                <div class="alert alert-danger text-center"> Sin Productos </div>
            </td>
        </tr>
        {% endif %}
          <tr>
            <th scope="row">Total:</th>
            <td colspan="2">$ {{total_carrito}}</td>
          </tr>
        </tbody>
      </table>
      <hr>
      </div>
      <div class="row text-center">
          <div class="col-6"><a href="{% url 'CLS' %}" class="btn btn-danger">Limpiar</a></div>
          <div class="col-6"><a href="#" class="btn btn-success">Guardar</a></div>
      </div>


  </div>

{% endblock  %}